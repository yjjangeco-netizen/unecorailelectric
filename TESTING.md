# 🧪 재고관리 시스템 테스트 가이드

이 문서는 재고관리 시스템의 핵심 기능들을 테스트하는 방법을 안내합니다.

## 📋 테스트 개요

재고관리 시스템은 다음 6가지 핵심 기능을 제공합니다:

1. **입고 기능** - 새 품목 등록 및 기존 품목 수량 증가
2. **출고 기능** - 선택된 품목 출고 및 재고 감소
3. **폐기 기능** - 품목 폐기 처리 및 이력 관리
4. **검색 기능** - 품명, 규격, 분류별 검색 및 필터링
5. **재고 계산** - 입출고 후 재고 수량 및 총액 계산 정확성
6. **데이터 무결성** - 음수 재고 방지 및 계산 정확성 검증

## 🚀 테스트 실행 방법

### 방법 1: 웹 브라우저 테스트 (권장)

1. 개발 서버 시작:
   ```bash
   npm run dev
   ```

2. 브라우저에서 테스트 페이지 접속:
   ```
   http://localhost:3000/test.html
   ```

3. 테스트 실행:
   - **전체 테스트 실행**: 모든 기능을 순차적으로 테스트
   - **개별 테스트 실행**: 각 기능을 개별적으로 테스트
   - **결과 초기화**: 테스트 결과를 초기화

### 방법 2: PowerShell 테스트

1. PowerShell에서 테스트 스크립트 실행:
   ```powershell
   .\test-powershell.ps1
   ```

2. 반복 테스트 실행 (100회):
   ```powershell
   .\test-powershell.ps1 -TestCount 100
   ```

### 방법 3: API 직접 테스트

1. 테스트 데이터 생성:
   ```bash
   curl -X POST http://localhost:3000/api/test/setup
   ```

2. 개별 API 테스트:
   ```bash
   # 입고 테스트
   curl -X POST http://localhost:3000/api/test/stock-in \
     -H "Content-Type: application/json" \
     -d '{"itemName":"테스트품목","quantity":100,"unitPrice":5000}'
   
   # 출고 테스트
   curl -X POST http://localhost:3000/api/test/stock-out \
     -H "Content-Type: application/json" \
     -d '{"itemId":"test_stock_1","quantity":10}'
   
   # 폐기 테스트
   curl -X POST http://localhost:3000/api/test/disposal \
     -H "Content-Type: application/json" \
     -d '{"itemId":"test_stock_1","quantity":5,"reason":"테스트폐기"}'
   
   # 검색 테스트
   curl -X POST http://localhost:3000/api/test/search \
     -H "Content-Type: application/json" \
     -d '{"query":"테스트","category":"","minPrice":0,"maxPrice":100000,"inStock":true}'
   ```

3. 통합 테스트 실행:
   ```bash
   curl -X POST http://localhost:3000/api/test/run-all
   ```

## 📊 테스트 결과 확인

### 웹 브라우저 테스트 결과

- **테스트 요약**: 총 테스트 수, 성공/실패 수, 성공률, 총 소요시간
- **개별 테스트 결과**: 각 테스트의 상태, 소요시간, 상세 정보
- **실시간 콘솔**: 테스트 실행 과정의 상세한 로그

### PowerShell 테스트 결과

- **콘솔 출력**: 각 테스트의 실행 상태와 결과
- **성공/실패 요약**: 전체 테스트 결과 통계
- **상세 오류 정보**: 실패한 테스트의 구체적인 오류 내용

## 🔍 테스트 시나리오

### 기본 테스트 시나리오

1. **신규 품목 입고**
   - 품목명: "테스트 품목 [타임스탬프]"
   - 수량: 100개
   - 단가: 5,000원
   - 예상 결과: 새 품목 생성, 재고 100개, 총액 500,000원

2. **기존 품목 입고**
   - 동일 품목명으로 추가 입고
   - 예상 결과: 기존 재고에 수량 추가, 단가 업데이트

3. **품목 출고**
   - 테스트 품목 10개 출고
   - 예상 결과: 재고 90개, 총액 450,000원

4. **품목 폐기**
   - 테스트 품목 5개 폐기
   - 예상 결과: 재고 85개, 총액 425,000원

5. **검색 및 필터링**
   - 키워드 검색: "테스트", "전기", "케이블"
   - 카테고리 필터: "전기자재"
   - 가격 범위: 1,000원 ~ 20,000원
   - 재고 상태: 재고 있음/없음

### 데이터 무결성 테스트

1. **음수 재고 방지**
   - 출고/폐기 시 재고가 음수가 되지 않는지 확인

2. **총액 계산 정확성**
   - 재고 수량 × 단가 = 총액이 정확한지 확인

3. **데이터 일관성**
   - 입고/출고/폐기 후 재고 수량이 정확히 반영되는지 확인

## ⚠️ 테스트 주의사항

### 환경 요구사항

- Node.js 18+ 및 npm 설치
- Supabase 프로젝트 설정 완료
- 환경 변수 설정 (.env.local)
- 데이터베이스 연결 확인

### 테스트 데이터 관리

- 테스트 데이터는 `test_` 접두사로 생성
- 테스트 완료 후 자동으로 정리됨
- 실제 운영 데이터에 영향 없음

### 성능 고려사항

- 대량 테스트 시 서버 부하 고려
- 테스트 간 적절한 대기 시간 설정
- 데이터베이스 연결 풀 모니터링

## 🐛 문제 해결

### 일반적인 오류

1. **연결 오류**
   - 개발 서버 실행 상태 확인
   - 포트 3000 사용 가능 여부 확인
   - 방화벽 설정 확인

2. **데이터베이스 오류**
   - Supabase 연결 설정 확인
   - RLS 정책 설정 확인
   - 테이블 스키마 확인

3. **API 오류**
   - 요청 형식 확인 (Content-Type, JSON 형식)
   - 필수 파라미터 누락 여부 확인
   - 응답 상태 코드 확인

### 디버깅 방법

1. **브라우저 개발자 도구**
   - Network 탭에서 API 요청/응답 확인
   - Console 탭에서 오류 메시지 확인

2. **PowerShell 오류 로그**
   - 상세한 오류 메시지와 스택 트레이스
   - 각 테스트 단계별 실행 상태

3. **서버 로그**
   - API 엔드포인트 실행 로그
   - 데이터베이스 쿼리 로그

## 📈 테스트 확장

### 추가 테스트 시나리오

1. **대용량 데이터 테스트**
   - 수천 개의 품목 데이터로 성능 테스트
   - 동시 사용자 시뮬레이션

2. **에러 케이스 테스트**
   - 잘못된 입력값 처리
   - 네트워크 오류 시나리오
   - 데이터베이스 연결 실패

3. **보안 테스트**
   - 인증/인가 검증
   - SQL 인젝션 방지
   - XSS 공격 방지

### 자동화 테스트

1. **CI/CD 파이프라인 통합**
   - GitHub Actions에서 자동 테스트
   - 배포 전 품질 검증

2. **성능 모니터링**
   - 응답 시간 측정
   - 리소스 사용량 모니터링
   - 임계값 기반 알림

## 📞 지원 및 문의

테스트 실행 중 문제가 발생하거나 추가 도움이 필요한 경우:

1. **로그 확인**: 각 테스트의 상세 로그 확인
2. **문서 참조**: API 문서 및 스키마 확인
3. **개발팀 문의**: 구체적인 오류 상황과 로그 제공

---

**마지막 업데이트**: 2024년 1월
**버전**: 1.0.0
